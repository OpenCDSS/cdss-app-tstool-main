<project name="CDSS" default="compile" basedir="../">
    
    <import file="../../cdss-util-buildtools/common-build.xml"/>
    <import file="../../cdss-util-buildtools/common-doc.xml"/>
    <import file="../../cdss-util-buildtools/common-installer.xml"/>
    
    <property file="conf/product-cdss.properties"/>
	
	<!-- Create the TSTool CDSS PDF user manuals, in several separate volumes to limite size -->
	<target name="create-user-manual-cdss" description="Merges PDF documentation into doc/dist_CDSS folder" >
        <mkdir dir="doc/UserManual/dist_CDSS/"/>
		<property name="pdfsrc.dir" location="doc/UserManual/Word" />
		<antcall target="create-user-manual-cdss-Vol1-Manual" inheritall="true"></antcall>
		<antcall target="create-user-manual-cdss-Vol2-CommandReference" inheritall="true"></antcall>
		<antcall target="create-user-manual-cdss-Vol3-DatastoreReference" inheritall="true"></antcall>
		<copy file="${pdfsrc.dir}/82_Appendix_ReleaseNotes.pdf" tofile="doc/UserManual/dist_CDSS/TSTool-ReleaseNotes.pdf"/>
		<copy file="${pdfsrc.dir}/82_Appendix_ReleaseNotes_Old.pdf" tofile="doc/UserManual/dist_CDSS/TSTool-ReleaseNotes-Old.pdf"/>
	</target>
	<target name="create-user-manual-cdss-Vol1-Manual" description="Merges PDF documentation into doc/dist_CDSS folder" >
		<property name="filelist" location="doc/UserManual/merge_PDF/UserManual_CDSS_Vol1_Manual_fileList.txt" />
		<property name="pdf_file" location="doc/UserManual/dist_CDSS/TSTool-Vol1-UserManual.pdf" />
		<antcall target="mergePDF" inheritall="true"></antcall>
	</target>
	<target name="create-user-manual-cdss-Vol2-CommandReference" description="Merges PDF documentation into doc/dist_CDSS folder" >
		<property name="filelist" location="doc/UserManual/merge_PDF/UserManual_CDSS_Vol2_CommandReference_fileList.txt" />
		<property name="pdf_file" location="doc/UserManual/dist_CDSS/TSTool-Vol2-CommandReference.pdf" />
		<antcall target="mergePDF" inheritall="true"></antcall>
	</target>
	<target name="create-user-manual-cdss-Vol3-DatastoreReference" description="Merges PDF documentation into doc/dist_CDSS folder" >
		<property name="filelist" location="doc/UserManual/merge_PDF/UserManual_CDSS_Vol3_DatastoreReference_fileList.txt" />
		<property name="pdf_file" location="doc/UserManual/dist_CDSS/TSTool-Vol3-DatastoreReference.pdf" />
		<antcall target="mergePDF" inheritall="true"></antcall>
	</target>
    
    <!-- this is called after standard-local-install and allows common resources to be copied in -->
    <target name="-install-local">
    	<!-- Run-time binary files. -->
        <copy todir="${install.dir}/bin" file="resources/runtime/bin-CDSS/TSTool.bat"/>
    	<copy todir="${install.dir}/bin" file="resources/runtime/bin/tstool-latest.bat"/>
        <copy todir="${install.dir}/bin" file="installer/common/TSTool.l4j.ini"/>
    	<!-- The following is a useful utility to help create a Linux distribution from a Windows distribution -->
        <copy todir="${install.dir}/bin" file="resources/runtime/bin/build-linux-distro"/>
    	<copy todir="${install.dir}/bin" file="resources/runtime/bin/tstool"/>
    	<!-- Binary files needed for HEC-DSS support beyond the jar files, which are handled automatically. -->
    	<copy todir="${install.dir}/bin" file="../cdss-lib-processor-ts-java/lib/heclib/javaHeclib.dll"/>
    	<copy todir="${install.dir}/bin" file="../cdss-lib-processor-ts-java/lib/heclib/rmaUtil.dll"/>
    	<copy todir="${install.dir}/bin" file="../cdss-lib-processor-ts-java/lib/heclib/DFORMDD.DLL"/>
    	<copy todir="${install.dir}/bin" file="../cdss-lib-processor-ts-java/lib/heclib/MSVCRTD.DLL"/>
    	<!-- Documentation -->
    	<mkdir dir="${install.dir}/doc/UserManual"/>
        <copy todir="${install.dir}/doc/UserManual" file="../cdss-app-tstool-doc/doc/UserManual/dist_CDSS/TSTool-ReleaseNotes.pdf"/>
    	<copy todir="${install.dir}/doc/UserManual" file="../cdss-app-tstool-doc/doc/UserManual/dist_CDSS/TSTool-ReleaseNotes-Old.pdf"/>
    	<copy todir="${install.dir}/doc/UserManual" file="../cdss-app-tstool-doc/doc/UserManual/dist_CDSS/TSTool-Vol1-UserManual.pdf"/>
    	<copy todir="${install.dir}/doc/UserManual" file="../cdss-app-tstool-doc/doc/UserManual/dist_CDSS/TSTool-Vol2-CommandReference.pdf"/>
    	<copy todir="${install.dir}/doc/UserManual" file="../cdss-app-tstool-doc/doc/UserManual/dist_CDSS/TSTool-Vol3-DatastoreReference.pdf"/>
    	<!-- Examples -->
    	<mkdir dir="${install.dir}/examples"/>
        <copy todir="${install.dir}/examples">
        	<fileset dir="resources/runtime/examples">
        		<include name="**/*.*"/>
        		</fileset>
        	</copy>
    	<!-- Log file folder -->
    	<mkdir dir="${install.dir}/logs"/>
    	<!-- Python scripts that utilize TSTool -->
    	<mkdir dir="${install.dir}/python/nrcs-snotel"/>
    	<copy todir="${install.dir}/python/nrcs-snotel" file="resources/runtime/python/nrcs-snotel/download-snotel.bat"/>
    	<copy todir="${install.dir}/python/nrcs-snotel" file="resources/runtime/python/nrcs-snotel/download-snotel.py"/>
    	<copy todir="${install.dir}/python/nrcs-snotel" file="resources/runtime/python/nrcs-snotel/download-snotel.doc"/>
    	<copy todir="${install.dir}/python/nrcs-snotel" file="resources/runtime/python/nrcs-snotel/TSlite.py"/>
    	<mkdir dir="${install.dir}/python/nrcs-snowcourse"/>
    	<copy todir="${install.dir}/python/nrcs-snowcourse" file="resources/runtime/python/nrcs-snowcourse/snowcourse2csv.py"/>
    	<mkdir dir="${install.dir}/python/table"/>
    	<copy todir="${install.dir}/python/table">
    		<fileset dir="resources/runtime/python/table">
    			<include name="*.py"/>
    			</fileset>
    		</copy>
    	<!-- System (configuration) files -->
    	<copy todir="${install.dir}/system" file="resources/runtime/system/ClimateDivisions.csv"/>
    	<copy todir="${install.dir}/system" file="resources/runtime/system/ColoradoWaterHBGuest.cfg"/>
    	<copy todir="${install.dir}/system" file="resources/runtime/system/ColoradoWaterSMS.cfg"/>
        <copy todir="${install.dir}/system" file="resources/runtime/system/DATAUNIT"/>
    	<copy todir="${install.dir}/system" file="resources/runtime/system/FIPS-county.csv"/>
    	<copy todir="${install.dir}/system" file="resources/runtime/system/FIPS-state.csv"/>
    	<copy todir="${install.dir}/system" file="resources/runtime/system/HydroBase.cfg"/>
    	<copy todir="${install.dir}/system" file="resources/runtime/system/HydroBase-HBGuest.cfg"/>
    	<copy todir="${install.dir}/system" file="resources/runtime/system/NrcsAwdb.cfg"/>
    	<copy todir="${install.dir}/system" file="resources/runtime/system/RCC-ACIS.cfg"/>
        <copy todir="${install.dir}/system" file="resources/runtime/system/UsgsNwisDaily.cfg"/>
    	<copy todir="${install.dir}/system" file="resources/runtime/system/UsgsNwisGroundwater.cfg"/>
    	<copy todir="${install.dir}/system" file="resources/runtime/system/UsgsNwisInstantaneous.cfg"/>
    	<copy todir="${install.dir}/system" file="resources/runtime/system-CDSS/TSTool.cfg"/>
    	<!-- System configuration file for CDSS.cfg included because HydroBase may be enabled -->
        <copy todir="${install.dir}/system" file="resources/runtime/system-CDSS/CDSS.cfg"/>
    	<mkdir dir="${install.dir}/doc/Training"/>
    	<copy todir="${install.dir}/doc/Training">
    		<fileset dir="../cdss-app-tstool-doc/doc/Training">
    			<include name="**/*.*"/>
    			<exclude name="**/*.chk"/>
    			<exclude name="**/*.log"/>
    			<exclude name="**/*.check.html"/>
    			<exclude name="**/*.ppt"/>
    			<exclude name="**/graphics/**"/>
    			</fileset>
    		</copy>
    </target>

</project>
